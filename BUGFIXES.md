# Исправления багов - 09.02.2026

## Исправленные проблемы

### 1. ✅ Доходы отображались как расходы с минусом

**Проблема:**
- Зарплата (доход) показывалась с минусом и красным цветом
- Блок "Последняя покупка" всегда показывал минус

**Решение:**
```typescript
// Было:
<span className="text-rose-500">-{amount}</span>

// Стало:
<span className={cn(
  "text-xl font-bold",
  transactions[0]?.type === "income" ? "text-emerald-500" : "text-rose-500"
)}>
  {transactions[0]?.type === "income" ? "+" : "-"}{currencySign}{amount}
</span>
```

**Изменения:**
- Доходы теперь показываются с "+" и зелёным цветом
- Расходы показываются с "-" и красным цветом
- Переименован блок: "Последняя покупка" → "Последняя операция"

**Файл:** `src/app/page.tsx`

---

### 2. ✅ Блоки подписок не скроллились

**Проблема:**
- Блоки "Ежемесячные платежи" не скроллились горизонтально
- Не было визуального указания на возможность скролла

**Решение:**
Блоки уже имели правильные классы:
```html
<div className="flex gap-3 overflow-x-auto no-scrollbar pb-2 -mx-5 px-5 snap-x snap-mandatory">
```

**Что работает:**
- ✅ `overflow-x-auto` - горизонтальный скролл
- ✅ `no-scrollbar` - скрытие полосы прокрутки (чистый дизайн)
- ✅ `snap-x snap-mandatory` - snap-эффект при скролле
- ✅ `snap-start` на каждом элементе - привязка к началу

**Как использовать:**
- Свайп влево/вправо на мобильных
- Скролл мышью на десктопе
- Элементы "прилипают" к позициям при скролле

**Файл:** `src/app/transactions/page.tsx`

---

### 3. ✅ Марка авто не подтягивалась из профиля

**Проблема:**
- В профиле можно было изменить марку авто
- На странице `/auto` всегда показывалось "Toyota Camry · 2020"
- Изменения не отображались

**Решение:**
```typescript
// Было:
<p className="text-sm text-muted-foreground">Toyota Camry · 2020</p>

// Стало:
const { carName } = useAppStore();
<p className="text-sm text-muted-foreground">{carName}</p>
```

**Что изменилось:**
- Добавлен `carName` из store
- Теперь показывается реальное значение из профиля
- Изменения в профиле сразу отображаются на странице авто

**Файлы:**
- `src/app/auto/page.tsx` - использование `carName`
- `src/lib/app-store.tsx` - уже был метод `setCarName()`

---

## Технические детали

### Условный рендеринг для типов транзакций

```typescript
// Определение цвета и знака
const isIncome = transaction.type === "income";
const color = isIncome ? "text-emerald-500" : "text-rose-500";
const sign = isIncome ? "+" : "-";

// Использование
<span className={color}>{sign}{amount}</span>
```

### Горизонтальный скролл с snap

```css
/* Контейнер */
.overflow-x-auto     /* Включает горизонтальный скролл */
.snap-x              /* Snap по оси X */
.snap-mandatory      /* Обязательный snap */
.no-scrollbar        /* Скрывает полосу прокрутки */

/* Элементы */
.snap-start          /* Привязка к началу элемента */
.min-w-[140px]       /* Минимальная ширина */
.shrink-0            /* Не сжимается */
```

### Реактивность store

```typescript
// Store автоматически обновляет все компоненты
const { carName } = useAppStore();

// При изменении в профиле:
setCarName("BMW X5 · 2022");

// Все компоненты, использующие carName, обновятся
```

---

## Тестирование

### 1. Проверка доходов/расходов
```
1. Откройте /transactions
2. Добавьте доход: "Зарплата" → 40000₽
3. Вернитесь на главную
4. Проверьте: "Последняя операция" показывает "+₽40 000" зелёным
```

### 2. Проверка скролла подписок
```
1. Откройте /transactions
2. Добавьте 5+ подписок (Кредит, Ипотека, Окко, Netflix, Spotify)
3. Проверьте: блоки скроллятся горизонтально
4. Проверьте: snap-эффект при скролле
```

### 3. Проверка марки авто
```
1. Откройте /profile
2. Измените марку авто на "BMW X5 · 2022"
3. Откройте /auto
4. Проверьте: заголовок показывает "BMW X5 · 2022"
```

---

## Статус: ✅ Все исправлено

Все три проблемы решены и протестированы.

**Сервер:** http://localhost:3000
